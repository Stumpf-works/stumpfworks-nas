#!/bin/bash
# postrm script for stumpfworks-nas
# This script runs after package removal

set -e

case "$1" in
    purge)
        # Remove data directory on purge (NOT on remove)
        if [ -d /var/lib/stumpfworks-nas ]; then
            echo "Removing data directory..."
            echo "WARNING: This will delete all data including database!"
            rm -rf /var/lib/stumpfworks-nas
        fi

        # Remove config directory on purge
        if [ -d /etc/stumpfworks-nas ]; then
            echo "Removing configuration directory..."
            rm -rf /etc/stumpfworks-nas
        fi

        # Reload systemd
        systemctl daemon-reload || true

        echo "Stumpf.Works NAS has been completely removed."
        ;;

    remove|upgrade|failed-upgrade|abort-install|abort-upgrade|disappear)
        # On remove (not purge), keep data for potential reinstall
        echo "Stumpf.Works NAS removed. Data preserved in /var/lib/stumpfworks-nas"
        echo "Use 'apt purge stumpfworks-nas' to remove all data."
        ;;

    *)
        echo "postrm called with unknown argument \`$1'" >&2
        exit 1
        ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
